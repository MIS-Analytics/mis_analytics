---
description: Universal helper functions
output-file: core.html
title: core

---


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## column helpers

---

[source](https://github.com/MIS-Analytics/mis_core/blob/main/mis_core/core.py#L12){target="_blank" style="float:right; font-size:smaller"}

### move_columns

```python

def move_columns(
    df:DataFrame, # Input
    cols_to_move:str, # Single
    pos:int, # Target
)->DataFrame:


```

*Move one or more columns to a specified position in a DataFrame.*


::: {#d1fdb820 .cell time_run='2026-01-20T17:05:17.929708+00:00'}
``` {.python .cell-code}
df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})
df
```

::: {.cell-output .cell-output-display execution_count=0}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::


::: {#2f274396 .cell time_run='2026-01-20T17:05:17.958309+00:00'}
``` {.python .cell-code}
move_columns(df, 'C', 0)
```

::: {.cell-output .cell-output-display execution_count=0}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::


::: {#83e93207 .cell time_run='2026-01-20T17:05:17.994755+00:00'}
``` {.python .cell-code}
sample_string = 'KnotenNr. der Stücklistenposition'
```
:::


::: {#96e89319 .cell time_run='2026-01-20T17:05:18.018480+00:00'}
``` {.python .cell-code}
sample_string = sample_string.lower()
sample_string
```

::: {.cell-output .cell-output-display execution_count=0}
```
'knotennr. der stücklistenposition'
```
:::
:::


::: {#10f42a4e .cell time_run='2026-01-20T17:05:18.042809+00:00'}
``` {.python .cell-code}
[c for c in sample_string][:10]
```

::: {.cell-output .cell-output-display execution_count=0}
```
['k', 'n', 'o', 't', 'e', 'n', 'n', 'r', '.', ' ']
```
:::
:::


::: {#93daa023 .cell time_run='2026-01-20T17:05:18.078015+00:00'}
``` {.python .cell-code}
[c.isalnum() for c in sample_string][:10]
```

::: {.cell-output .cell-output-display execution_count=0}
```
[True, True, True, True, True, True, True, True, False, False]
```
:::
:::


::: {#2f2c0464 .cell time_run='2026-01-20T17:05:18.288963+00:00'}
``` {.python .cell-code}
[c if c.isalnum() else '_' for c in sample_string][:10]
```

::: {.cell-output .cell-output-display execution_count=0}
```
['k', 'n', 'o', 't', 'e', 'n', 'n', 'r', '_', '_']
```
:::
:::


::: {#deb125da .cell time_run='2026-01-20T17:05:18.290873+00:00'}
``` {.python .cell-code}
sample_string = "".join([c if c.isalnum() else '_' for c in sample_string])
sample_string
```

::: {.cell-output .cell-output-display execution_count=0}
```
'knotennr__der_stücklistenposition'
```
:::
:::


::: {#0726a14d .cell time_run='2026-01-20T17:05:18.322959+00:00'}
``` {.python .cell-code}
sample_string.split('_')
```

::: {.cell-output .cell-output-display execution_count=0}
```
['knotennr', '', 'der', 'stücklistenposition']
```
:::
:::


::: {#855f311f .cell time_run='2026-01-20T17:05:18.355356+00:00'}
``` {.python .cell-code}
[o for o in filter(None, sample_string.split('_'))]
```

::: {.cell-output .cell-output-display execution_count=0}
```
['knotennr', 'der', 'stücklistenposition']
```
:::
:::


::: {#7ccf2bf5 .cell time_run='2026-01-20T17:05:18.385223+00:00'}
``` {.python .cell-code}
'_'.join(filter(None,sample_string.split('_')))
```

::: {.cell-output .cell-output-display execution_count=0}
```
'knotennr_der_stücklistenposition'
```
:::
:::


---

[source](https://github.com/MIS-Analytics/mis_core/blob/main/mis_core/core.py#L34){target="_blank" style="float:right; font-size:smaller"}

### clean_string

```python

def clean_string(
    input_string:str
):


```

*Cleans input_string*


::: {#e786d956 .cell time_run='2026-01-20T17:05:18.453201+00:00'}
``` {.python .cell-code}
clean_string(sample_string)
```

::: {.cell-output .cell-output-display execution_count=0}
```
'knotennr_der_stücklistenposition'
```
:::
:::


---

[source](https://github.com/MIS-Analytics/mis_core/blob/main/mis_core/core.py#L40){target="_blank" style="float:right; font-size:smaller"}

### clean_col_names

```python

def clean_col_names(
    df:DataFrame
)->DataFrame:


```

*Returns df with clean column names by using [`clean_string`](https://MIS-Analytics.github.io/mis_core/core.html#clean_string) on each column name.*


::: {#acff701e .cell time_run='2026-01-20T17:07:57.102317+00:00'}
``` {.python .cell-code}
df.head(2)
```

::: {.cell-output .cell-output-display execution_count=0}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cust_ID.</th>
      <th>Order--Date</th>
      <th>Prdct.Name!</th>
      <th>QTY___Ordered</th>
      <th>Unit$Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>101</td>
      <td>2024-02-01</td>
      <td>Widget A</td>
      <td>10</td>
      <td>99.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>102</td>
      <td>2024-02-02</td>
      <td>Widget B</td>
      <td>20</td>
      <td>149.99</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::


::: {#9faebcbe .cell time_run='2026-01-20T17:08:10.283061+00:00'}
``` {.python .cell-code}
df = clean_col_names(df)
df.head(2)
```

::: {.cell-output .cell-output-display execution_count=0}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>order_date</th>
      <th>prdct_name</th>
      <th>qty_ordered</th>
      <th>unit_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>101</td>
      <td>2024-02-01</td>
      <td>Widget A</td>
      <td>10</td>
      <td>99.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>102</td>
      <td>2024-02-02</td>
      <td>Widget B</td>
      <td>20</td>
      <td>149.99</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::


## validate functions

Tests to check if we use out of scope variables inside function

::: {#1934706e .cell time_run='2026-01-20T13:49:15.847491+00:00'}
``` {.python .cell-code}
a = 10
```
:::


::: {#718fdb96 .cell time_run='2026-01-20T13:49:15.848406+00:00'}
``` {.python .cell-code}
def my_sum(b):
    return a + b

my_sum(32)
```

::: {.cell-output .cell-output-display execution_count=0}
```
42
```
:::
:::


::: {#6ae8596e .cell time_run='2026-01-20T13:49:15.849705+00:00'}
``` {.python .cell-code}
import inspect
```
:::


::: {#30db3d4b .cell time_run='2026-01-20T13:49:15.871537+00:00'}
``` {.python .cell-code}
# inspect.getclosurevars(eval("my_sum"))
inspect.getclosurevars(my_sum)
```

::: {.cell-output .cell-output-display execution_count=0}
```
ClosureVars(nonlocals={}, globals={'a': 10}, builtins={}, unbound=set())
```
:::
:::


::: {#e1f57a8d .cell time_run='2026-01-20T13:49:15.873215+00:00'}
``` {.python .cell-code}
def my_callback(result):
    print("Cell just finished running!")

get_ipython().events.register('post_run_cell', my_callback)
```

::: {.cell-output .cell-output-stdout}
```
Cell just finished running!
```
:::
:::


::: {#ca42b0c1 .cell time_run='2026-01-20T13:49:15.906879+00:00'}
``` {.python .cell-code}
get_ipython().events.unregister('post_run_cell', my_callback)
```
:::


::: {#5643f5d3 .cell time_run='2026-01-20T13:49:15.943048+00:00'}
``` {.python .cell-code}
import ast
```

::: {.cell-output .cell-output-stdout}
```
Functions defined: ['check_funcs']
```
:::
:::


::: {#aded58d1 .cell}
``` {.python .cell-code}
def check_funcs(result):
    tree = ast.parse(result.info.raw_cell)
    func_names = [node.name for node in ast.walk(tree) if isinstance(node, ast.FunctionDef)]
    if func_names:
        print(f"Functions defined: {func_names}")
```
:::


::: {#7488e110 .cell}
``` {.python .cell-code}
get_ipython().events.register('post_run_cell', check_funcs)
```
:::


::: {#e81d2145 .cell time_run='2026-01-20T13:49:15.974690+00:00'}
``` {.python .cell-code}
get_ipython().events.unregister('post_run_cell', check_funcs)
```
:::


::: {#6cea8b22 .cell time_run='2026-01-20T13:49:16.014555+00:00'}
``` {.python .cell-code}
def check_funcs(result):
    tree = ast.parse(result.info.raw_cell)
    func_names = [node.name for node in ast.walk(tree) if isinstance(node, ast.FunctionDef)]
    if func_names:
        print(f"Functions defined: {func_names}")
```

::: {.cell-output .cell-output-stdout}
```
Functions defined: ['check_funcs']
```
:::
:::


::: {#0e33e27b .cell}
``` {.python .cell-code}
get_ipython().events.register('post_run_cell', check_funcs)
```
:::


::: {#0523d109 .cell time_run='2026-01-20T13:49:16.042421+00:00'}
``` {.python .cell-code}
get_ipython().events.unregister('post_run_cell', check_funcs)
```
:::


::: {#13703e75 .cell time_run='2026-01-20T13:49:16.063890+00:00'}
``` {.python .cell-code}
import ast
import inspect
```
:::


::: {#0a683bc8 .cell time_run='2026-01-20T13:49:16.094714+00:00'}
``` {.python .cell-code}
def check_global_deps(result):
    tree = ast.parse(result.info.raw_cell)
    func_names = [node.name for node in ast.walk(tree) if isinstance(node, ast.FunctionDef)]
    
    ns = get_ipython().user_ns
    for name in func_names:
        if name in ns:
            func = ns[name]
            cv = inspect.getclosurevars(func)
            if cv.globals:
                print(f"⚠️  '{name}' depends on global variables: {list(cv.globals.keys())}")
```
:::


::: {#0c89c436 .cell time_run='2026-01-20T13:50:09.617521+00:00'}
``` {.python .cell-code}
get_ipython().events.register('post_run_cell', check_global_deps)
```
:::


::: {#e8e689d3 .cell time_run='2026-01-20T13:50:10.538416+00:00'}
``` {.python .cell-code}
def my_sum(b):
    return a + b

my_sum(32)
```

::: {.cell-output .cell-output-display execution_count=0}
```
42
```
:::

::: {.cell-output .cell-output-stdout}
```
⚠️  'my_sum' depends on global variables: ['a']
```
:::
:::


::: {#0e2956b2 .cell time_run='2026-01-20T13:50:13.484224+00:00'}
``` {.python .cell-code}
get_ipython().events.unregister('post_run_cell', check_global_deps)
```
:::


